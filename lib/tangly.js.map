{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 41e50ae70894abc2b0de","webpack:///./src/crypto.js","webpack:///./src/index.js","webpack:///external \"CryptoJS\"","webpack:///./src/iota.js","webpack:///external \"IOTA\""],"names":["encrypt","seed","data","CryptoJS","AES","JSON","stringify","toString","decrypt","encryptedData","bytes","parse","enc","Utf8","Tangly","constructor","config","node","iota","insert","console","log","dataObject","attachedData","attachToTangle","decryptedData","find","field","accountData","getAccountData","messages","extractTransferMessages","Iota","Promise","resolve","reject","api","err","getNewAddress","address","sendTransfer","transferData","transferObject","transfers","forEach","transfer","message","utils","extractJson","fromTrytes","trytes","newAddress","toTrytes","tag","then","catch"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;AC7DA;;AAEO,SAASA,OAAT,CAAiBC,IAAjB,EAAuBC,IAAvB,EAA6B;AAClC,SAAO,iDAAAC,CAASC,GAAT,CAAaJ,OAAb,CAAqBK,KAAKC,SAAL,CAAeJ,IAAf,CAArB,EAA2CD,IAA3C,EAAiDM,QAAjD,EAAP;AACD;;AAEM,SAASC,OAAT,CAAiBP,IAAjB,EAAuBQ,aAAvB,EAAsC;AAC3C,MAAIC,QAAQ,iDAAAP,CAASC,GAAT,CAAaI,OAAb,CAAqBC,cAAcF,QAAd,EAArB,EAA+CN,IAA/C,CAAZ;AACA,SAAOI,KAAKM,KAAL,CAAWD,MAAMH,QAAN,CAAe,iDAAAJ,CAASS,GAAT,CAAaC,IAA5B,CAAX,CAAP;AACD,C;;;;;;;;;;ACTD;AACA;;AAEe,MAAMC,MAAN,CAAa;AAC1BC,cAAYC,MAAZ,EAAoB;AAClB,SAAKf,IAAL,GAAYe,OAAOf,IAAnB;AACA,SAAKgB,IAAL,GAAYD,OAAOC,IAAnB;AACA,SAAKC,IAAL,GAAY,IAAI,sDAAJ,CAAS,KAAKD,IAAd,EAAoB,KAAKhB,IAAzB,CAAZ;AACD;;AAED,QAAMkB,MAAN,CAAajB,IAAb,EAAmBc,MAAnB,EAA2B;AACzBI,YAAQC,GAAR,CAAY,cAAZ;AACA,UAAMZ,gBAAgB,gEAAAT,CAAQ,KAAKC,IAAb,EAAmBC,IAAnB,CAAtB;AACAkB,YAAQC,GAAR,CAAa,mBAAkBZ,aAAc,EAA7C;AACA,UAAMa,aAAa;AACjBb;AADiB,KAAnB;AAGA;AACA,UAAMc,eAAe,MAAM,KAAKL,IAAL,CAAUM,cAAV,CAAyBF,UAAzB,EAAqCN,MAArC,CAA3B;AACAI,YAAQC,GAAR,CAAY,eAAZ,EAA6BE,YAA7B;;AAEA,UAAME,gBAAgB,gEAAAjB,CAAQ,KAAKP,IAAb,EAAmBQ,aAAnB,CAAtB;AACAW,YAAQC,GAAR,CAAa,mBAAkBhB,KAAKC,SAAL,CAAemB,aAAf,CAA8B,EAA7D;AACD;;AAED,QAAMC,IAAN,CAAWC,KAAX,EAAkB;AAChBP,YAAQC,GAAR,CAAY,mBAAZ;AACA,UAAMO,cAAc,MAAM,KAAKV,IAAL,CAAUW,cAAV,EAA1B;AACA,UAAMC,WAAW,KAAKZ,IAAL,CAAUa,uBAAV,CAAkCH,WAAlC,CAAjB;AACAR,YAAQC,GAAR,CAAY,eAAZ,EAA6BO,WAA7B;AACD;AA3ByB,C;;;;;;;;ACH5B,+C;;;;;;;;;;ACAA;AACA;;AAEe,MAAMI,IAAN,CAAW;AACxBjB,cAAYE,IAAZ,EAAkBhB,IAAlB,EAAwB;AACtB,SAAKiB,IAAL,GAAY,IAAI,mDAAJ,CAAS;AACnB,kBAAYD;AADO,KAAT,CAAZ;AAGA,SAAKhB,IAAL,GAAYA,IAAZ;AACD;;AAED4B,mBAAiB;AACf,WAAO,IAAII,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,aAAO,KAAKjB,IAAL,CAAUkB,GAAV,CAAcP,cAAd,CAA6B,KAAK5B,IAAlC,EAAwC,EAAxC,EAA4C,UAAUoC,GAAV,EAAeT,WAAf,EAA4B;AAC7E,YAAIS,GAAJ,EAAS;AACPjB,kBAAQC,GAAR,CAAYgB,GAAZ;AACA,iBAAOF,OAAOE,GAAP,CAAP;AACD;AACD,eAAOH,QAAQN,WAAR,CAAP;AACD,OANM,CAAP;AAOD,KARM,CAAP;AASD;;AAEDU,kBAAgB;AACd,WAAO,IAAIL,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,aAAO,KAAKjB,IAAL,CAAUkB,GAAV,CAAcE,aAAd,CAA4B,KAAKrC,IAAjC,EAAuC,CAACoC,GAAD,EAAME,OAAN,KAAkB;AAC9D,YAAIF,GAAJ,EAAS;AACP,iBAAOF,OAAOE,GAAP,CAAP;AACD;AACD,eAAOH,QAAQK,OAAR,CAAP;AACD,OALM,CAAP;AAMD,KAPM,CAAP;AAQD;;AAEDC,eAAaC,YAAb,EAA2B;AACzB,WAAO,IAAIR,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,aAAO,KAAKjB,IAAL,CAAUkB,GAAV,CAAcI,YAAd,CAA2B,KAAKvC,IAAhC,EAAsC,CAAtC,EAAyC,CAAzC,EAA4CwC,YAA5C,EAA0D,CAACJ,GAAD,EAAMK,cAAN,KAAyB;AACxF,YAAIL,GAAJ,EAAS;AACP,iBAAOF,OAAOE,GAAP,CAAP;AACD;AACD,eAAOH,QAAQQ,cAAR,CAAP;AACD,OALM,CAAP;AAMD,KAPM,CAAP;AAQD;;AAEDX,0BAAwBH,WAAxB,EAAqC;AACnCA,gBAAYe,SAAZ,CAAsBC,OAAtB,CAA+BC,QAAD,IAAc;AAC1C;AACA,UAAIC,UAAU,KAAK5B,IAAL,CAAU6B,KAAV,CAAgBC,WAAhB,CAA4BH,QAA5B,CAAd;AACA,UAAIC,YAAY,IAAhB,EAAsB;;AAEtBA,gBAAUzC,KAAKM,KAAL,CAAWmC,OAAX,CAAV;AACA,UAAIA,QAAQrC,aAAZ,EAA2B;AACzBW,gBAAQC,GAAR,CAAY,qBAAZ,EAAmC,mEAAAb,CAAQ,KAAKP,IAAb,EAAmB6C,QAAQrC,aAA3B,CAAnC;AACD;AACF,KATD;AAUD;;AAEDwC,aAAWC,MAAX,EAAmB;AACjB,WAAO,KAAKhC,IAAL,CAAU6B,KAAV,CAAgBE,UAAhB,CAA2BC,MAA3B,CAAP;AACD;;AAED,QAAM1B,cAAN,CAAqBtB,IAArB,EAA2Bc,MAA3B,EAAmC;AACjC;AACA,UAAMmC,aAAa,MAAM,KAAKb,aAAL,EAAzB;AACA;AACA,UAAMG,eAAe,CAAC;AACpB,iBAAWU,UADS;AAEpB,eAAS,CAFW;AAGpB,iBAAW,KAAKjC,IAAL,CAAU6B,KAAV,CAAgBK,QAAhB,CAAyB/C,KAAKC,SAAL,CAAeJ,IAAf,CAAzB,CAHS;AAIpB,aAAOc,OAAOqC;AAJM,KAAD,CAArB;AAMA,SAAKb,YAAL,CAAkBC,YAAlB,EACGa,IADH,CACSZ,cAAD,IAAoB;AACxBtB,cAAQC,GAAR,CAAY,kBAAZ,EAAgCqB,cAAhC;AACA,aAAOD,YAAP;AACD,KAJH,EAKGc,KALH,CAKUlB,GAAD,IAAS;AACdjB,cAAQC,GAAR,CAAY,KAAZ,EAAmBgB,GAAnB;AACD,KAPH;AAQD;AA7EuB,C;;;;;;;;ACH1B,+C","file":"tangly.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"CryptoJS\"), require(\"IOTA\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"tangly\", [\"CryptoJS\", \"IOTA\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tangly\"] = factory(require(\"CryptoJS\"), require(\"IOTA\"));\n\telse\n\t\troot[\"tangly\"] = factory(root[\"CryptoJS\"], root[\"IOTA\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_4__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 41e50ae70894abc2b0de","import CryptoJS from 'crypto-js';\n\nexport function encrypt(seed, data) {\n  return CryptoJS.AES.encrypt(JSON.stringify(data), seed).toString();\n}\n\nexport function decrypt(seed, encryptedData) {\n  var bytes = CryptoJS.AES.decrypt(encryptedData.toString(), seed);\n  return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\n}\n\n\n// WEBPACK FOOTER //\n// ./src/crypto.js","import { encrypt, decrypt } from './crypto';\nimport Iota from './iota';\n\nexport default class Tangly {\n  constructor(config) {\n    this.seed = config.seed;\n    this.node = config.node;\n    this.iota = new Iota(this.node, this.seed);\n  }\n\n  async insert(data, config) {\n    console.log(\"INSERTING...\");\n    const encryptedData = encrypt(this.seed, data);\n    console.log(`encrypted data: ${encryptedData}`);\n    const dataObject = {\n      encryptedData\n    };\n    debugger;\n    const attachedData = await this.iota.attachToTangle(dataObject, config);\n    console.log(\"attachedData:\", attachedData);\n\n    const decryptedData = decrypt(this.seed, encryptedData);\n    console.log(`decrypted data: ${JSON.stringify(decryptedData)}`);\n  }\n\n  async find(field) {\n    console.log(\"finding fields...\")\n    const accountData = await this.iota.getAccountData();\n    const messages = this.iota.extractTransferMessages(accountData);\n    console.log(\"account data:\", accountData);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"CryptoJS\"\n// module id = 2\n// module chunks = 0","import IOTA from 'iota.lib.js';\nimport { decrypt } from './crypto.js';\n\nexport default class Iota {\n  constructor(node, seed) {\n    this.iota = new IOTA({\n      'provider': node\n    });\n    this.seed = seed;\n  }\n\n  getAccountData() {\n    return new Promise((resolve, reject) => {\n      return this.iota.api.getAccountData(this.seed, {}, function (err, accountData) {\n        if (err) {\n          console.log(err)\n          return reject(err);\n        }\n        return resolve(accountData);\n      })\n    })\n  }\n\n  getNewAddress() {\n    return new Promise((resolve, reject) => {\n      return this.iota.api.getNewAddress(this.seed, (err, address) => {\n        if (err) {\n          return reject(err);\n        }\n        return resolve(address);\n      })\n    })\n  }\n\n  sendTransfer(transferData) {\n    return new Promise((resolve, reject) => {\n      return this.iota.api.sendTransfer(this.seed, 4, 9, transferData, (err, transferObject) => {\n        if (err) {\n          return reject(err);\n        }\n        return resolve(transferObject);\n      })\n    })\n  }\n\n  extractTransferMessages(accountData) {\n    accountData.transfers.forEach((transfer) => {\n      debugger;\n      let message = this.iota.utils.extractJson(transfer);\n      if (message === null) return;\n\n      message = JSON.parse(message);\n      if (message.encryptedData) {\n        console.log(\"decrypted message: \", decrypt(this.seed, message.encryptedData));\n      }\n    })\n  }\n\n  fromTrytes(trytes) {\n    return this.iota.utils.fromTrytes(trytes)\n  }\n\n  async attachToTangle(data, config) {\n    debugger;\n    const newAddress = await this.getNewAddress();\n    debugger;\n    const transferData = [{\n      'address': newAddress,\n      'value': 0,\n      'message': this.iota.utils.toTrytes(JSON.stringify(data)),\n      'tag': config.tag\n    }]\n    this.sendTransfer(transferData)\n      .then((transferObject) => {\n        console.log(\"transfer object:\", transferObject);\n        return transferData;\n      })\n      .catch((err) => {\n        console.log(\"err\", err);\n      })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/iota.js","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"IOTA\"\n// module id = 4\n// module chunks = 0"],"sourceRoot":""}