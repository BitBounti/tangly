{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap a9c9ab66de149b829f44","webpack:///./src/crypto.js","webpack:///./src/iota.js","webpack:///./src/index.js","webpack:///external \"CryptoJS\"","webpack:///external \"IOTA\"","webpack:///./src/util/format.js"],"names":["iota","IOTA","encrypt","seed","data","CryptoJS","AES","JSON","stringify","toString","decrypt","encryptedData","bytes","parse","enc","Utf8","generateSecretKey","replace","c","crypto","getRandomValues","Uint8Array","generateHash","secret","SHA256","seedGen","length","charset","i","result","window","values","Uint32Array","Error","generateTag","tagSuffix","hash","trytes","utils","toTrytes","trimmedTrytes","slice","finalTag","Iota","constructor","node","tagSecret","getAccountData","Promise","resolve","reject","api","err","accountData","console","log","getNewAddress","address","sendTransfer","transferData","transferObject","extractTransferMessages","transfers","reduce","acc","transfer","message","extractJson","decryptedMessage","timestamp","push","fromTrytes","text","findTransaction","tag","findTransactionObjects","tags","transactions","attachToTangle","options","newAddress","Tangly","config","createTag","searchTag","generateSeed","insert","dataObject","attachedData","find","field","history","rawMessages","formattedData","untangle","mergeMessagesWithHistory","messages","key","value","mergeMessagesWithoutHistory","hasOwnProperty","unshift","separateObjects","item","separatedMessages","finalObject"],"mappings":"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","file":"tangly.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"CryptoJS\"), require(\"IOTA\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"tangly\", [\"CryptoJS\", \"IOTA\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tangly\"] = factory(require(\"CryptoJS\"), require(\"IOTA\"));\n\telse\n\t\troot[\"tangly\"] = factory(root[\"CryptoJS\"], root[\"IOTA\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_4__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a9c9ab66de149b829f44","import CryptoJS from 'crypto-js';\nimport Iota from '../src/iota';\n\nconst iota = new IOTA();\n\nexport function encrypt(seed, data) {\n  return CryptoJS.AES.encrypt(JSON.stringify(data), seed).toString();\n}\n\nexport function decrypt(seed, encryptedData) {\n  var bytes = CryptoJS.AES.decrypt(encryptedData.toString(), seed);\n  return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\n}\n\nexport function generateSecretKey() {\n  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\n    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n  )\n}\n\nexport function generateHash(seed, secret) {\n  return CryptoJS.SHA256(secret + seed).toString()\n}\n\nexport function seedGen(length) {\n  var charset = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ9\";\n  var i;\n  var result = \"\";\n  if (window.crypto && window.crypto.getRandomValues) {\n    var values = new Uint32Array(length);\n    window.crypto.getRandomValues(values);\n    for (i = 0; i < length; i++) {\n      result += charset[values[i] % charset.length];\n    }\n    return result;\n  } else\n    throw new Error(\n      \"Your browser sucks and can't generate secure random numbers\"\n    );\n};\n\nexport function generateTag(seed, secret, tagSuffix=\"999\") {\n  // use a seed and a secret token to generate a 24 character tryte. 3 extra characters can be added for querying purposes.\n  const hash = CryptoJS.SHA256(secret + seed).toString();\n  const trytes = iota.utils.toTrytes(hash);\n  const trimmedTrytes = trytes.slice(0, 24);\n  const finalTag = trimmedTrytes + tagSuffix;\n\n  return finalTag;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/crypto.js","import IOTA from 'iota.lib.js';\nimport { decrypt, generateHash } from './crypto.js';\n\nexport default class Iota {\n  constructor(node, seed, tagSecret) {\n    this.iota = new IOTA({\n      'provider': node\n    });\n    this.seed = seed;\n    this.tagSecret = tagSecret;\n  }\n\n  getAccountData() {\n    return new Promise((resolve, reject) => {\n      return this.iota.api.getAccountData(this.seed, {}, function (err, accountData) {\n        if (err) {\n          console.log(err)\n          return reject(err);\n        }\n        return resolve(accountData);\n      })\n    })\n  }\n\n  getNewAddress() {\n    return new Promise((resolve, reject) => {\n      return this.iota.api.getNewAddress(this.seed, (err, address) => {\n        if (err) {\n          return reject(err);\n        }\n        return resolve(address);\n      })\n    })\n  }\n\n  sendTransfer(transferData) {\n    return new Promise((resolve, reject) => {\n      return this.iota.api.sendTransfer(this.seed, 3, 14, transferData, (err, transferObject) => {\n        if (err) {\n          return reject(err);\n        }\n        return resolve(transferObject);\n      })\n    })\n  }\n\n  extractTransferMessages(accountData) {\n    return accountData.transfers.reduce((acc, transfer) => {\n      let message = this.iota.utils.extractJson(transfer);\n      if (message === null) return;\n\n      message = JSON.parse(message);\n      if (message.encryptedData) {\n        const decryptedMessage = decrypt(this.seed, message.encryptedData);\n        decryptedMessage.timestamp = transfer[0].timestamp;\n        acc.push(decryptedMessage);\n\n        return acc;\n      }\n    }, [])\n  }\n\n  fromTrytes(trytes) {\n    return this.iota.utils.fromTrytes(trytes)\n  }\n\n  toTrytes(text) {\n    return this.iota.utils.toTrytes(text)\n  }\n\n  findTransaction(tag) {\n    return new Promise((resolve, reject) => {\n      return this.iota.api.findTransactionObjects({ tags: [ tag ]}, (err, transactions) => {\n        if (err) {\n          console.log(err)\n          return reject(err);\n        }\n        return resolve(transactions);\n      })\n    })\n  }\n\n  generateTag() {\n    // use a seed and a secret token to generate a 24 character tryte. 3 extra characters can be added for querying purposes.\n    const hash = generateHash(this.seed, this.tagSecret);\n    const trytes = this.iota.utils.toTrytes(hash);\n    const trimmedTrytes = trytes.slice(0, 27);\n    const finalTag = trimmedTrytes;\n    console.log(\"tag:\", finalTag);\n    return finalTag;\n  }\n\n  async attachToTangle(data, options = {}) {\n    const newAddress = await this.getNewAddress();\n    const transferData = [{\n      'address': newAddress,\n      'value': 0,\n      'message': this.iota.utils.toTrytes(JSON.stringify(data)),\n      'tag': options.tag || this.generateTag()\n    }]\n    return await this.sendTransfer(transferData)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/iota.js","import { encrypt, decrypt, generateTag, generateSecretKey, seedGen } from './crypto';\nimport Iota from './iota';\nimport { untangle } from './util/format';\n\nexport default class Tangly {\n  constructor(config) {\n    this.seed = config.seed;\n    this.node = config.node;\n    this.tagSecret = config.tagSecret;\n    this.iota = new Iota(this.node, this.seed, this.tagSecret);\n  }\n\n  createTag() {\n    return this.iota.generateTag();\n  }\n\n  async searchTag(tag) {\n    return await this.iota.findTransaction(tag);\n  }\n\n  generateSeed() {\n    return seedGen(81);\n  }\n\n  async insert(data, options) {\n    console.log(\"INSERTING...\");\n    const encryptedData = encrypt(this.seed, data);\n    console.log(`encrypted data: ${encryptedData}`);\n    const dataObject = { encryptedData };\n    const attachedData = await this.iota.attachToTangle(dataObject, options);\n\n    return attachedData;\n  }\n\n  async find(field, options={ history: true, timestamp: true }) {\n    console.log(\"finding fields...\")\n    const accountData = await this.iota.getAccountData();\n    const rawMessages = this.iota.extractTransferMessages(accountData);\n    const formattedData = untangle(rawMessages, options);\n\n    return formattedData;\n    console.log(`raw messages: ${JSON.stringify(rawMessages)}`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"CryptoJS\"\n// module id = 3\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"IOTA\"\n// module id = 4\n// module chunks = 0","\nfunction mergeMessagesWithHistory(messages) {\n  return messages.reduce((acc, message) => {\n    for (let key in message) {\n      // if the property already exists in the acc, add it to the history of the new object and\n      // replace the old object with the new in the acc\n      if (acc[key]) {\n        message.history.push({\n          value: acc[key]\n        })\n      }\n      acc[key] = message[key];\n    }\n    return acc;\n  }, {})\n}\n\nfunction mergeMessagesWithoutHistory(messages) {\n  return messages.reduce((acc, message) => {\n    for (let key in message) {\n      acc[key] = message[key];\n    }\n    return acc;\n  }, {})\n}\n\nfunction mergeMessagesWithHistory(messages) {\n  return messages.reduce((acc, message) => {\n    for (let key in message) {\n      if (acc.hasOwnProperty(key)) {\n        if (acc[key].history) {\n          message[key].history = acc[key].history;\n          message[key].history.unshift({ value: acc[key].value, timestamp: acc[key].timestamp });\n        } else {\n          message[key].history = [];\n          message[key].history.push(acc[key]);\n        }\n        acc[key] = message[key];\n      } else {\n        acc[key] = message[key];\n      }\n    }\n    return acc;\n  }, {})\n}\n\nfunction separateObjects(messages) {\n  return messages.reduce((acc, message) => {\n    for (let item in message) {\n      if (item !== 'timestamp') {\n        acc.push({ [item]: { value: message[item], timestamp: message.timestamp } });\n      }\n    }\n\n    return acc;\n  }, [])\n};\n\nexport function untangle(messages, options) {\n  const separatedMessages = separateObjects(messages);\n  console.log(\"separated messages:\", separatedMessages);\n  if (options.history) {\n    return mergeMessagesWithHistory(separatedMessages);\n  } else {\n    return mergeMessagesWithoutHistory(separatedMessages);\n  }\n  console.log(`Final Object: ${ JSON.stringify(finalObject) }`)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/format.js"],"sourceRoot":""}